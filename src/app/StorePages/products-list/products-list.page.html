<ion-header>


  <ion-toolbar *ngIf="!showSearch else showSearchBar">
    <ion-title>{{(userStore|async)?.data.storeInfo.name}}</ion-title>
    <ion-buttons slot="start">
      <ion-button *ngIf="canSelect else showMenu" (click)="cancel()">
        <ion-icon slot="icon-only" name="close"></ion-icon>
      </ion-button>
      <ng-template #showMenu>
          <ion-menu-toggle>
              <ion-button>
                <ion-icon name="menu" slot="icon-only">
                </ion-icon>
              </ion-button>
            </ion-menu-toggle>
      </ng-template>
    </ion-buttons>
    <ion-buttons slot="end">
        <ion-button *ngIf='canSelect else normal' (click)="showNewProduct()">
            <ion-icon slot="icon-only" name="add"></ion-icon>
          </ion-button>
          <ng-template #normal>
            <ion-button [routerLink]="'/EditProduct/new'">
              <ion-icon slot="icon-only" name="add"></ion-icon>
            </ion-button>
          </ng-template>
      <ion-button (click)="backView()" *ngIf="toggleView; else toggleViewButton">
        <ion-icon slot="icon-only" name="arrow-forward"></ion-icon>
      </ion-button>
      <ng-template #toggleViewButton>
        <ion-button (click)="presentPopover($event)">
          <ion-icon slot="icon-only" name="more"></ion-icon>
        </ion-button>
      </ng-template>
    </ion-buttons>
  </ion-toolbar>
  <ng-template #showSearchBar>
      <ion-toolbar>
          <ion-buttons slot="start">
              <ion-button *ngIf="canSelect else showMenu" (click)="cancel()">
                <ion-icon slot="icon-only" name="close"></ion-icon>
              </ion-button>
              <ng-template #showMenu>
                  <ion-menu-toggle>
                      <ion-button>
                        <ion-icon name="menu" slot="icon-only">
                        </ion-icon>
                      </ion-button>
                    </ion-menu-toggle>
              </ng-template>
            </ion-buttons>
                  <ion-searchbar *ngIf="showSearch" aria-label="search" [formControl]="searchControl" #searchBar>
          </ion-searchbar>
          <ion-buttons slot="primary">
            <ion-button (click)="toggleSearch()">
              <img [src]="showSearch ? '/assets/svg/search-close.svg' : '/assets/svg/search.svg'" />
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      
    </ng-template>
  
</ion-header>


<ion-content no-badding color="dark">

  <ion-list #slidingItem1 *ngIf="(view === 'LIST' || view === 'CARDS'); else slidesView">
    <app-product-view *ngFor="let product of filteredProducts|async; let i=index; trackBy: trackByFn"
      [product]="product" [options]="{view: view === 'LIST' ? 'ITEM' : 'CARD', editable:true}"
      (copy)="showCopyProduct(product)" (edit)="showEditProduct(product.id)" (delete)="delete(product)"
      (prodClick)="onProductClicked(product,i)"></app-product-view>
  </ion-list>

  <!-- 
    <ion-list #slidingItem1 *ngIf="(view === 'LIST' || view === 'CARDS'); else slidesView">
    <app-product-view *ngFor="let product of filteredProducts|async" [product]="product"
      [options]="{view: view === 'LIST' ? 'ITEM' : 'CARD', editable:true}"
      (copy)="showCopyProduct(product)" (edit)="showEditProduct(product.id)"
      (delete)="delete(product)"></app-product-view>
  </ion-list>
 -->


  <ng-template #slidesView>
    <ng-container *ngIf="view === 'SLIDES'; else gridView" #slids>

      <ion-slides style="height:100%;" [options]="{initialSlide:slideIndex}">
        <ion-slide *ngFor="let product of filteredProducts|async" style=" height: 100%;"
          (click)="showSlideDetails = !showSlideDetails">
          <!-- https://css-tricks.com/almanac/properties/o/object-fit/ -->
          <div class="swiper-zoom-container">
            <ion-fab vertical="top" horizontal="end" slot="fixed">
              <ion-fab-button class="slideMoreFAB" size="small">
                <ion-icon name="more"></ion-icon>
              </ion-fab-button>
              <ion-fab-list side="bottom">
                <!-- <ion-fab-button (click)="showEditProduct(product.id)">Edit</ion-fab-button> -->
                <ion-fab-button [routerLink]="'/EditProduct/'+product.id">Edit</ion-fab-button>
                <ion-fab-button (click)="showCopyProduct(product)">Copy</ion-fab-button>
                <ion-fab-button (click)="delete(product)">Delete</ion-fab-button>
              </ion-fab-list>

            </ion-fab>
            <app-product-view [product]="product" [options]="{view: 'SLIDE', editable:false}"
              style="width: inherit; height: inherit;"></app-product-view>
          </div>
        </ion-slide>

        <!-- https://css-tricks.com/almanac/properties/o/object-fit/ -->
      </ion-slides>
      <ng-container *ngIf="showSlideDetails">
        <!-- [ngClass]="slids.el.dir ==='rtl' ? 'swiper-button-next' : 'swiper-button-prev'" 
       *ngIf="!slids.isBeginning()" 
      -->
        <div class='swiper-button-next' (click)="slids.slidePrev()"></div>
        <!--
               [ngClass]="slids.el.dir !=='rtl' ? 'swiper-button-next' : 'swiper-button-prev'"
             *ngIf="!slids.isEnd()"
              -->
        <div class='swiper-button-prev' (click)="slids.slideNext()"></div>
      </ng-container>
    </ng-container>

  </ng-template>

  <ng-template #gridView>
    <div class="images">
      <app-product-view class="one-image" *ngFor="let product of filteredProducts|async; let i=index"
        [product]="product" [options]="{view:'THUMB', editable:false}" (prodClick)="onProductClicked(product,i)">
      </app-product-view>

    </div>
  </ng-template>

</ion-content>
<ion-footer>
</ion-footer>